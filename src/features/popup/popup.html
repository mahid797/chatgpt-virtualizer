<!doctype html>
<html>

<head>
  <meta charset="utf-8" />
  <title>ChatGPT Virtualizer</title>
  <link rel="stylesheet" href="popup.css" />
</head>

<body>
  <header class="topbar">
    <img class="logo-img" src="assets/icon.png" alt="ChatGPT Virtualizer" />
    <div class="title">
      <h1>ChatGPT Virtualizer</h1>
      <p class="sub">Keep long threads snappy</p>
    </div>
    <a id="openShortcuts" class="toolbar-link" href="#" title="Manage keyboard shortcuts">Shortcuts</a>
    <label class="switch" title="Enable on this tab">
      <input id="enabled" type="checkbox" />
      <span class="slider"></span>
    </label>
  </header>

  <main>
    <section class="card">
      <h2>Auto-collapse rules</h2>
      <div class="row">
        <label for="keepN" class="label">Always keep the last</label>
        <div class="field-inline">
          <input id="keepN" type="number" min="0" step="1" inputmode="numeric" placeholder="8" />
          <span class="suffix">turns</span>
          <button id="btnApplyKeepN" class="btn btn-nowrap" type="button"
            title="Save this value and immediately collapse older turns">Apply</button>
        </div>
        <p class="help">New replies always remain visible. Pinned turns are never collapsed.</p>
      </div>
    </section>

    <section class="card">
      <h2>Bulk actions</h2>
      <div class="actions">
        <button id="btnExpand" class="btn primary"
          title="Temporarily expand every turn in the thread. Tip: Shift-click a chevron to pin a turn so it stays open.">
          Expand all turns <span class="kbd" data-hotkey="expand">Ctrl+Shift+9</span>
        </button>
        <button id="btnCollapseOlder" class="btn"
          title="Collapse everything that appears above the first visible message in the page right now.">
          Collapse above viewport <span class="kbd" data-hotkey="collapse">Ctrl+Shift+8</span>
        </button>
      </div>

      <div class="row compact">
        <label for="beforeTarget" class="label">Collapse everything aboveâ€¦</label>
        <div class="field-inline" style="width: 100%;">
          <input id="beforeTarget" type="text" placeholder="Chat #"
            title="Use #number for position (1 = first turn), or paste a data-turn-id." />
          <button id="btnCollapseBeforeTarget" class="btn btn-nowrap"
            title="Collapse every earlier turn (above the chosen one).">Collapse</button>
        </div>
        <p class="help">Examples: <code>1</code> keeps only the very first turn expanded;
        </p>
      </div>

      <p class="help">Bulk actions affect only the currently active ChatGPT tab.</p>
    </section>
  </main>

  <footer class="foot">
    <span class="foot-text">Tips: Shift-click a chevron to pin (while expanded). Alt-click clears the pin.</span>
  </footer>

  <script type="module" src="popup.js"></script>
</body>

</html>